@inherits DNNrocketAPI.render.DNNrocketTokens<Simplisity.SimplisityRazor>
@using DNNrocketAPI;

@AddMetaData("resourcepath", "/DesktopModules/DNNrocket/api/App_LocalResources/")

@{
    var plugin = (SystemRecord)Model.List.First();
}

<span class="w3-section simplisity_buttons" id="buttonsrequired" style="display:none;">
    <button class="w3-button w3-green w3-padding-8 simplisity_click" s-cmd="systemapi_admin_save" s-post="#pluginsdatasection" s-before="PrePostInterfaceList">@ResourceKey("DNNrocket.cmdSaveButton")</button>
    <button class="w3-button w3-red w3-padding-8 simplisity_confirmclick" s-confirm="@ResourceKey("DNNrocket.cmdDelete","","confirm")" s-cmd="systemapi_admin_delete" s-post="#pluginsdatasection" s-return="#contentplaceholder" s-after="reloadpluginlist">@ResourceKey("DNNrocket.cmdDeleteButton")</button>
    <button class="w3-button w3-sand w3-padding-8 simplisity_click" s-cmd="systemapi_admin_getsystemlist" s-fields="theme:config-w3,template:Admin_Systems.cshtml,systemprovider:systemapi" s-return="#contentplaceholder">@ResourceKey("DNNrocket.cmdReturnButton")</button>
</span>



<div class="w3-container">

    <div class="w3-container">
        <h2>@plugin.Info().GetXmlProperty("genxml/textbox/systemname")</h2>

        <div class="w3-row">
            <a href="javascript:void(0)" onclick="openSection(event, 'pluginsdatasection');">
                <div class="w3-col tablink w3-bottombar w3-hover-light-blue w3-padding w3-border-blue w3-light-blue " style="width:15%"><i class="fa fa-home"></i>&nbsp;@ResourceKey("system.systemdata")</div>
            </a>
            <a href="javascript:void(0)" onclick="openSection(event, 'Groups');">
                <div class="w3-col tablink w3-bottombar w3-hover-light-blue w3-padding" style="width:15%"><i class="fa fa-link"></i>&nbsp;@ResourceKey("system.menugroups")</div>
            </a>
            <a href="javascript:void(0)" onclick="openSection(event, 'provtypes');">
                <div class="w3-col tablink w3-bottombar w3-hover-light-blue w3-padding" style="width:15%"><i class="fa fa-handshake-o"></i>&nbsp;@ResourceKey("system.provtypes")</div>
            </a>
            <a href="javascript:void(0)" onclick="openSection(event, 'Interface');">
                <div class="w3-col tablink w3-bottombar w3-hover-light-blue w3-padding" style="width:15%"><i class="fa fa-link"></i>&nbsp;@ResourceKey("system.interfaces")</div>
            </a>
            <a href="javascript:void(0)" onclick="openSection(event, 'parameters');">
                <div class="w3-col tablink w3-bottombar w3-hover-light-blue w3-padding" style="width:15%"><i class="fa fa-indent"></i>&nbsp;@ResourceKey("system.idxfield")</div>
            </a>
            <a href="javascript:void(0)" onclick="openSection(event, 'settings');">
                <div class="w3-col tablink w3-bottombar w3-hover-light-blue w3-padding" style="width:15%"><i class="fa fa-cog"></i>&nbsp;@ResourceKey("system.settings")</div>
            </a>
        </div>

        <!--<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">-->
        <div id="pluginsdatasection" class="w3-container w3-margin tabsection" style="display:block;">
            @RenderTemplate("Admin_SystemDetailData.cshtml", "\\DesktopModules\\DNNrocket\\API", "config-w3", Model)
        </div>

        <div id="provtypes" class="w3-container tabsection" style="display:none">
            @RenderTemplate("Admin_SystemDetailProvType.cshtml", "\\DesktopModules\\DNNrocket\\API", "config-w3", Model)
        </div>

        <div id="Groups" class="w3-container tabsection" style="display:none">
            @RenderTemplate("Admin_SystemDetailGroups.cshtml", "\\DesktopModules\\DNNrocket\\API", "config-w3", Model)
        </div>

        <div id="Interface" class="w3-container tabsection" style="display:none">
            @RenderTemplate("Admin_SystemDetailInterfaces.cshtml", "\\DesktopModules\\DNNrocket\\API", "config-w3", Model)
        </div>

        <div id="parameters" class="w3-container tabsection" style="display:none">
            @RenderTemplate("Admin_SystemDetailIdxFields.cshtml", "\\DesktopModules\\DNNrocket\\API", "config-w3", Model)
        </div>

        <div id="settings" class="w3-container tabsection" style="display:none">
            @RenderTemplate("Admin_SystemDetailSettings.cshtml", "\\DesktopModules\\DNNrocket\\API", "config-w3", Model)
        </div>

    </div>
       
</div>


<script type="text/javascript">

    function AccordianFunction(id) {
        var x = document.getElementById(id);
        if (x.className.indexOf("w3-show") === -1) {
            x.className += " w3-show";
        } else {
            x.className = x.className.replace(" w3-show", "");
        }
    }

    function PrePostInterfaceList() {
        $('#xmlupdatemodeldata').val(simplisity_getxmlitems('#plugininterfaces', '.interfacedata', ''));
        $('#xmlupdateparamdata').val(simplisity_getxmlitems('#pluginparameters', '.parameterdata', ''));
        $('#xmlupdatesettings').val(simplisity_getxmlitems('#pluginsettings', '.settingsdata', ''));
        $('#xmlupdategroups').val(simplisity_getxmlitems('#plugingroups', '.groupsdata', ''));        
        $('#xmlupdateprovtypes').val(simplisity_getxmlitems('#pluginprovtypes', '.provtypesdata', ''));                
    }

    function reloadpluginlist() {
        $('#contentplaceholder').getSimplisity('/DesktopModules/DNNrocket/api/api.ashx', 'systemapi_admin_getsystemlist', 'theme:config-w3,template:Admin_Systems.cshtml,systemprovider:systemapi');
    };

    function openSection(evt, sectionName) {
        var i, x, tablinks;
        x = document.getElementsByClassName("tabsection");
        for (i = 0; i < x.length; i++) {
          x[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablink");
        for (i = 0; i < x.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" w3-border-blue", "");
            tablinks[i].className = tablinks[i].className.replace(" w3-light-blue", "");
        }
        document.getElementById(sectionName).style.display = "block";
        evt.currentTarget.firstElementChild.className += " w3-border-blue";
        evt.currentTarget.firstElementChild.className += " w3-light-blue";        
    }

</script>
