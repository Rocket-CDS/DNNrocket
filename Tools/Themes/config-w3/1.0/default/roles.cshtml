@inherits Rocket.Tools.RocketToolsTokens<Simplisity.SimplisityRazor>
@using DNNrocketAPI;
@using System
@using System.Linq
@using System.Xml
@using Simplisity;
@using DNNrocketAPI.Componants;
@using RazorEngine.Text;

@AddProcessData("resourcepath", "/DesktopModules/DNNrocket/api/App_LocalResources/")
@AddProcessData("resourcepath", "/DesktopModules/DNNrocket/Tools/App_LocalResources/")


<h1>Module Roles</h1>

<div class="w3-container w3-border w3-light-grey w3-margin-bottom">
    <div class="w3-third">
        <h3>
            @ResourceKey("DNNrocket.pages")
        </h3>
    </div>
    <div class="w3-third">
        <h3>
            @ResourceKey("DNNrocket.modules")
        </h3>
    </div>
    <div class="w3-third">
        <h3>
            @ResourceKey("DNNrocket.roles")
        </h3>
    </div>
</div>

<div class="w3-row">

    <div class="w3-third">
        <div class="w3-row w3-padding">
            <div class="w3-button w3-col m3 w3-blue w3-small" id="checkAll">@ResourceKey("DNNrocket.checkall")</div>
            @ButtonGap()
            <div class="w3-button w3-col m3 w3-blue w3-small" id="uncheckAll">@ResourceKey("DNNrocket.uncheckall")</div>
            @ButtonGap()
            <div class="w3-button w3-col m3 w3-green w3-right w3-small nextbuttonpage simplisity_click" style="display:none;" s-cmd="rocketroles_getmodules" s-return=".moduledatasection" s-fields='' s-post="#treeview2_container">@ResourceKey("DNNrocket.next")&nbsp;<i class="fas fa-caret-right"></i></div>
        </div>
        <div id="treeview2_container" class="hummingbird-treeview well h-scroll-large">
            @GetTreeTabList(Model.GetSettingInt("portalid"), new List<int>(), "treeview2", "", "class='hummingbird-base'")
        </div>
    </div>
    <div  class="w3-twothird" id="updatesection">
        <div class="w3-half moduledatasection">
        </div>
        <div class="w3-half rolesdatasection">
        </div>
    </div>
</div>


<script>

    $(document).ready(function () {

        simplisity_setParamField('pageref', CreateGuid())

        $.fn.hummingbird.defaults.SymbolPrefix = "fas";
        $.fn.hummingbird.defaults.collapsedSymbol = "fa-caret-down";
        $.fn.hummingbird.defaults.expandedSymbol = "fa-caret-up";

        $("#treeview2").hummingbird();


        $("#checkAll").click(function () {
            $("#treeview2").hummingbird("checkAll");
        });
        $("#uncheckAll").click(function () {
            $("#treeview2").hummingbird("uncheckAll");
        });
        $("#collapseAll").click(function () {
            $("#treeview2").hummingbird("collapseAll");
        });

        $("#treeview2").on("nodeChecked", function(){
            $('.nextbuttonpage').show();
            $('.moduledatasection').text('');
            $('.rolesdatasection').text('');            
        });
        $("#treeview2").on("nodeUnchecked", function(){
            $('.nextbuttonpage').show();
            $('.moduledatasection').text('');
            $('.rolesdatasection').text('');            
        });
    });

    function CreateGuid() {
        function _p8(s) {
            var p = (Math.random().toString(16) + "000000000").substr(2, 8);
            return s ? "-" + p.substr(0, 4) + "-" + p.substr(4, 4) : p;
        }
        return _p8() + _p8(true) + _p8(true) + _p8();
    }


</script>

